correct the calculation of output

add training process